MediathekCrawler.BroadcastView=function(){var a={},b=null,c=null,d=null,e=null,f=function(){b=$("#video-wrapper"),c=$("#video_html5_api"),$video_element=$("#video"),d=$("#info-wrapper"),$descriptionWrapper=$("#description-wrapper"),$("#choosePlaylist").on("click",k),$("#addToBookmarks").on("click",l)},g=function(){var a;return a=$("#xs-helper").is(":visible")?"Schlecht, Mittel, Gut, Hoch":$("#sm-helper").is(":visible")?"Mittel, Schlecht, Gut, Hoch":$("#md-helper").is(":visible")?"Hoch, Gut, Mittel, Schlecht":$("#lg-helper").is(":visible")?"Hoch, Gut, Mittel, Schlecht":"Hoch, Gut, Mittel, Schlecht"},h=function(a){var b=localStorage.getItem("mediathek-crawler"),f=JSON.parse(b);e=f._results[a],sources=[];for(var i=e._streams.length-1;i>=0;i--){var j='<source class="source" src="'+e._streams[i]._url+'" type="'+e._streams[i]._type+'" data-res="'+p(e._streams[i]._quality)+'">';$video_element.append(j),c.append(j),source_b={type:e._streams[i]._type,src:e._streams[i]._url,"data-res":p(e._streams[i]._quality)},sources.push(source_b),url=e._streams[i]._url}var k=g();video=videojs("#video"),video.options().sources=sources,$("#video>.source").remove(),video.resolutionSelector({force_types:["video/mp4"],default_res:k});var l="<h3>Titel :</h3><div>"+e._title+"</div>"+"<div>"+e._subtitle+"</div>"+"<h3>Ausstrahlung :</h3>"+"<div>"+e._airtime+"</div>"+"<h3>Dauer :</h3>"+"<div>"+e._length+"</div>"+"<h3>Sender :</h3>"+'<div id="icon-station" data-toggle="tooltip" data-placement="right" title="'+e._station+'"></div><div id="station">'+e._station+"</div>";d.prepend(l);var n="<div>"+e._details+"</div>";$descriptionWrapper.append(n),o(e._station),m(e)},i=function(){e=JSON.parse($("#bookmark").val())[0];var b=JSON.parse(e.url);sources=[];for(var f=b.length-1;f>=0;f--){var h='<source src="'+b[f]._url+'" type="'+b[f]._type+'" data-res="'+p(b[f]._quality)+'">';$video_element.append(h),c.append(h),source_b={type:b[f]._type,src:b[f]._url,"data-res":p(b[f]._quality)},sources.push(source_b),url=b[f]._url}var i=g();video=videojs("#video"),video.options().sources=sources,$("#video>.source").remove(),video.resolutionSelector({force_types:["video/mp4"],default_res:i});var j="<h3>Titel:</h3><div>"+e.title+"</div>"+"<div>"+e.subtitle+"</div>"+"<h3>Ausstrahlung:</h3>"+"<div>"+e.airtime.replace(/(\d{4})-(\d{2})-(\d{2})/,"$3.$2.$1")+"</div>"+"<h3>Dauer:</h3>"+"<div>"+e.duration+"</div>"+"<h3>Sender:</h3>"+'<div id="icon-station"></div><div id="station">'+e.station+"</div>";d.prepend(j);var k="<div>"+e.details+"</div>";$descriptionWrapper.append(k),o(e.station),m(e)},j=function(){$("#selectPlaylist").addClass("hidden"),$.ajax({type:"GET",url:"/playlists/new/"+$("input[name='playlistName']").val(),data:{title:e._title?e._title:e.title?e.title:0,subtitle:e._subtitle?e._subtitle:e.subtitle?e.subtitle:0,airtime:e._airtime?e._airtime:e.airtime?e.airtime:0,url:e._streams?e._streams:e.url?JSON.parse(e.url):0,duration:e._length?e._length:e.duration?e.duration:0,image:e._teaserImages?e._teaserImages:e.image?JSON.parse(e.image):0,details:e._details?e._details:e.details?e.details:0,station:e._station?e._station:e.station?e.station:0},dataType:"json"}),setTimeout($("#playlistForm").load("video.blade.php #playlistForm"),600),$("#playlistForm").attr("id","oldform"),$(a).trigger("feedback",["addNewPlaylist"]),$("#button-create-playlist-broadcast").on("click",j)},k=function(b){b.preventDefault(),$("#selectPlaylist").removeClass("hidden"),$("#button-create-playlist-broadcast").on("click",j),$("#add-to-playlist").on("click",function(b){$(a).trigger("feedback",["addPlaylist"]),b.preventDefault(),$("#selectPlaylist").addClass("hidden"),$.ajax({type:"GET",url:"/playlists/add/"+$("#select").val()+"/1",data:{title:e._title?e._title:e.title?e.title:0,subtitle:e._subtitle?e._subtitle:e.subtitle?e.subtitle:0,airtime:e._airtime?e._airtime:e.airtime?e.airtime:0,url:e._streams?e._streams:e.url?JSON.parse(e.url):0,duration:e._length?e._length:e.duration?e.duration:0,image:e._teaserImages?e._teaserImages:e.image?JSON.parse(e.image):0,details:e._details?e._details:e.details?e.details:0,station:e._station?e._station:e.station?e.station:0},dataType:"json"}),setTimeout($("#playlistForm").load("video.blade.php #playlistForm"),600)}),$("#add-to-playlist-cancel").on("click",function(a){return a.preventDefault(),$("#selectPlaylist").addClass("hidden"),!1})},l=function(b){b.preventDefault(),$(a).trigger("feedback",["addBookmark"]),$("#addToBookmarks").addClass("hidden"),$("#bookmark-name").removeClass("hidden").html('<span class="glyphicon glyphicon-bookmark"></span>Gemerkt'),$.ajax({type:"GET",url:"/bookmarks/add/"+$(this).val(),data:{title:e._title?e._title:e.title?e.title:0,subtitle:e._subtitle?e._subtitle:e.subtitle?e.subtitle:0,airtime:e._airtime?e._airtime:e.airtime?e.airtime:0,url:e._streams?e._streams:e.url?JSON.parse(e.url):0,duration:e._length?e._length:e.duration?e.duration:0,image:e._teaserImages?e._teaserImages:e.image?JSON.parse(e.image):0,details:e._details?e._details:e.details?e.details:0,station:e._station?e._station:e.station?e.station:0},dataType:"json",success:function(a){n(a)}})},m=function(a){var b=JSON.parse($("#all-bookmarks").text());for(var c in b)(b[c].title==a._title||b[c].title==a.title)&&(id=b[c].id,$("#addToBookmarks").addClass("hidden"),$("#bookmark-name").removeClass("hidden").html('<span class="glyphicon glyphicon-bookmark"></span>Gemerkt'),n(id))},n=function(b){$("#bookmark-name").click(function(c){c.preventDefault(),$(a).trigger("feedback",["deleteBookmark"]),$("#addToBookmarks").removeClass("hidden"),$("#bookmark-name").addClass("hidden"),$.ajax({type:"GET",url:"/bookmarks/delete/"+b,data:{}})})},o=function(a){$("#icon-station").tooltip(),a=a.toLowerCase(),a.indexOf("erste")>-1&&$("#icon-station").append("<img src='/css/images/Das_Erste_2014.svg' />"),"zdf"==a&&$("#icon-station").append("<img src='/css/images/ZDF.svg' />"),a.indexOf("zdfneo")>-1&&$("#icon-station").append("<img src='/css/images/ZDFneo.svg' />"),a.indexOf("zdfinfo")>-1&&$("#icon-station").append("<img src='/css/images/ZDFinfo.svg' />"),a.indexOf("zdf.kultur")>-1&&$("#icon-station").append("<img src='/css/images/Zdf.kultur_logo.svg' />"),a.indexOf("srf")>-1&&$("#icon-station").append("<img src='/css/images/srf.svg' />"),a.indexOf("arte")>-1&&$("#icon-station").append("<img src='/css/images/Arte.svg' />"),a.indexOf("br")>-1&&$("#icon-station").append("<img src='/css/images/br.svg' />"),a.indexOf("orf")>-1&&$("#icon-station").append("<img src='/css/images/ORF_logo.svg' />")},p=function(a){return 3==a?"Hoch":2==a?"Gut":1==a?"Mittel":0==a?"Schlecht":void 0};return dispose=function(){a={}},a.init=f,a.dispose=dispose,a.renderVideoById=h,a.renderVideoBookmark=i,a};